/*Exercicio 01*/
SELECT COD_FILME, COUNT(*) AS QtdLocacoes FROM LOCACOES GROUP BY COD_FILME;
 
/*Exercicio 02*/
SELECT F.FILME, L.DATA_DEVOLUCAO FROM FILME F JOIN LOCACOES L ON F.COD_FILME = L.COD_FILME
JOIN CLIENTES C ON L.COD_CLIENTE = C.COD_CLIENTE WHERE F.COD_CATEGORIA IN (SELECT COD_CATEGORIA FROM CATEGORIA
WHERE NOME_CATEGORIA = 'Ação') AND F.DIRETOR = 'Richard Donner' AND C.NOME = 'Edson Martin Feitosa';
 
/*Exercicio 03*/
SELECT FILME, VALOR_LOCACAO, VALOR_LOCACAO * 0.1 AS DESCONTO, 
VALOR_LOCACAO - (VALOR_LOCACAO * 0.1) AS Valor_Final FROM FILME;
 
/*Exercicio 04*/
SELECT DISTINCT F.* FROM FILME F JOIN LOCACOES L ON F.COD_FILME = L.COD_FILME
JOIN CLIENTES C ON L.COD_CLIENTE = C.COD_CLIENTE WHERE C.CIDADE = 'Votorantim';
 
/*Exercicio 05 - Sera a data atual de base do sistema operacional do computador*/
SELECT F.FILME FROM FILME F
JOIN LOCACOES L ON F.COD_FILME = L.COD_FILME
WHERE CONVERT(DATE, L.DATA_RETIRADA) = CONVERT(DATE, GETDATE());
 
 
/*Exercicio 06*/
SELECT SUM(F.VALOR_LOCACAO) AS Lucro FROM FILME F JOIN LOCACOES L
ON F.COD_FILME = L.COD_FILME WHERE F.FILME = 'A vida é bela';
 
/*Exercicio 07*/
SELECT F.DIRETOR, COUNT(*) AS QtdLocacoes FROM FILME F JOIN LOCACOES L ON
F.COD_FILME = L.COD_FILME GROUP BY F.DIRETOR;
 
/*Exercicio 08*/
SELECT DISTINCT CA.NOME_CATEGORIA FROM CLIENTES CL
JOIN LOCACOES L ON CL.COD_CLIENTE = L.COD_CLIENTE JOIN FILME F ON L.COD_FILME = F.COD_FILME
JOIN CATEGORIA CA ON F.COD_CATEGORIA = CA.COD_CATEGORIA WHERE CL.NOME = 'Maria Chiquinha';
 
 
/*Exercicio 09*/
SELECT DISTINCT C.NOME, C.TELEFONE FROM CLIENTES C JOIN LOCACOES L ON C.COD_CLIENTE = L.COD_CLIENTE
JOIN FILME F ON L.COD_FILME = F.COD_FILME WHERE F.FILME = 'Constantine';
 
/*Exercicio 10*/
SELECT NOME_CATEGORIA FROM CATEGORIA WHERE COD_CATEGORIA NOT IN (SELECT DISTINCT COD_CATEGORIA FROM FILME);